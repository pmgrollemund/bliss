<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to BLiSS method â€¢ bliss</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to BLiSS method">
<meta property="og:description" content="bliss">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bliss</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BlissIntro.html">Introduction to BLiSS method</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="BlissIntro_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to BLiSS method</h1>
                        <h4 class="author">Paul-Marie Grollemund</h4>
            
            <h4 class="date">2021-12-17</h4>
      
      
      <div class="hidden name"><code>BlissIntro.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit">
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">bliss</span><span class="op">)</span></pre></div>
<p>This vignette describes step by step how to use the BLiSS method. Below, you can find the following implemented features:</p>
<ul>
<li>Simulate data to test the BLiSS model</li>
<li>Obtain a sample of the posterior distribution with a Gibbs Sampler</li>
<li>Plot the posterior distribution of the coefficient function and the posterior distribution of the support</li>
<li>Compute the different Bayesian estimators</li>
</ul>
<div id="one-single-functional-covariate-case" class="section level1">
<h1 class="hasAnchor">
<a href="#one-single-functional-covariate-case" class="anchor"></a>One single functional covariate case</h1>
<div id="simulate-a-data-set" class="section level2">
<h2 class="hasAnchor">
<a href="#simulate-a-data-set" class="anchor"></a>Simulate a data set</h2>
<p>In order to simulate a proper dataset for Bliss application, some characteristics must be specified:</p>
<ul>
<li>
<span class="math inline">\(n\)</span> (the number of observations),</li>
<li>
<span class="math inline">\(p\)</span> (number of instant of measure),</li>
<li>beta<span class="math inline">\(\_\)</span>types (the shape of the coefficient function), and</li>
<li>grids<span class="math inline">\(\_\)</span>lim, a 2-vector (to define the domain of curves <span class="math inline">\(x_{i}(.)\)</span>).</li>
</ul>
<p>Based on these parameters, data can be simulated (curves <span class="math inline">\(x_{i}(.)\)</span> and real values <span class="math inline">\(y_{i}\)</span>) from the functional linear regression model by using the <em>sim</em> function, as suggested in the following chunck.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
  <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="va">param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>                        <span class="co"># define the "param" to simulate data</span>
                Q<span class="op">=</span><span class="fl">1</span>,                    <span class="co"># the number of functional covariate</span>
                n<span class="op">=</span><span class="fl">100</span>,                  <span class="co"># n is the sample size and p is the</span>
                p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>,                <span class="co"># number of time observations of the curves</span>
                beta_types<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"smooth"</span><span class="op">)</span>, <span class="co"># define the shape of the "true" coefficient function</span>
                grids_lim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># Give the beginning and the end of the observation's domain of the functions.</span>

  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim.html">sim</a></span><span class="op">(</span><span class="va">param</span><span class="op">)</span> <span class="co"># Simulate the data</span></pre></div>
</div>
<div id="how-to-apply-the-bliss-method" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-apply-the-bliss-method" class="anchor"></a>How to apply the Bliss method</h2>
<p>In order to apply the Bliss method, the main function to use is <em>fit<span class="math inline">\(\_\)</span>Bliss</em>. This function provides the following outputs:</p>
<ul>
<li>a posterior sample of the Bliss model,</li>
<li>an approximation of the posterior distribution of the coefficient function,</li>
<li>a piecewise constant estimate (stepfunction) of the coefficient function, which is computed thanks to an optimization algorithm,</li>
<li>an estimation of the support, which shoulb be useful if your purpose is to detect periods for which the functional coviarate has an (linear) impact on the dependent scalar variable,</li>
<li>the posterior densities of the posterior sample, which should be used to compute model choice criterion.</li>
</ul>
<p>An important required argument of the previous function is <strong>param</strong>, which is a list containing:</p>
<ul>
<li>
<strong>iter</strong>, the number of iterations for the Gibbs algorithm,</li>
<li>
<strong>burnin</strong> the number of iteration to drop at the beginning of the Gibbs Sampler,</li>
<li>
<strong>K</strong>, hyperparameter <span class="math inline">\(K\)</span> of the Bliss model,</li>
<li>
<strong>grids</strong>, the grid of instant for which the curves <span class="math inline">\(x_{i}(.)\)</span> are measured,</li>
<li>
<strong>prior<span class="math inline">\(\_\)</span>beta</strong>, an argument specifying a prior distribution of the slope coefficient <span class="math inline">\(\beta\)</span>, (only the <strong>Ridge<span class="math inline">\(\_\)</span>Zellner</strong> case is considered in this vignette),</li>
<li>and <strong>phi<span class="math inline">\(\_\)</span>l</strong>, an argument specifying a prior distribution for <span class="math inline">\(\ell\)</span> the half-width of the intervals (only the <strong>Gamma`</strong> case is considered in this vignette),</li>
</ul>
<p>Find below, an example of use of this function and a sketch of the structure of the returned object.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
  <span class="va">param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>            <span class="co"># define the required values of the Bliss method.</span>
                iter<span class="op">=</span><span class="fl">1e3</span>,   <span class="co"># The number of iteration of the main numerical algorithm of Bliss.</span>
                burnin<span class="op">=</span><span class="fl">2e2</span>, <span class="co"># The number of burnin iteration for the Gibbs Sampler</span>
                K<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>     <span class="co"># The number of intervals of the beta</span>

   
  <span class="va">res_bliss</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/fit_Bliss.html">fit_Bliss</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">data</span>,param<span class="op">=</span><span class="va">param</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Sample from the posterior distribution.</span>
<span class="co">#&gt; Gibbs Sampler: </span>
<span class="co">#&gt;   Initialization.</span>
<span class="co">#&gt;   Determine the starting point.</span>
<span class="co">#&gt;   Start the Gibbs Sampler.</span>
<span class="co">#&gt;   10%</span>
<span class="co">#&gt;   20%</span>
<span class="co">#&gt;   30%</span>
<span class="co">#&gt;   40%</span>
<span class="co">#&gt;   50%</span>
<span class="co">#&gt;   60%</span>
<span class="co">#&gt;   70%</span>
<span class="co">#&gt;   80%</span>
<span class="co">#&gt;   90%</span>
<span class="co">#&gt;   100%</span>
<span class="co">#&gt;   Return the result.</span>
<span class="co">#&gt; Coefficient function: smooth estimate.</span>
<span class="co">#&gt; Coefficient function: Bliss estimate.</span>
<span class="co">#&gt; Compute the approximation of the posterior distribution.</span>
<span class="co">#&gt; Support estimation.</span>
<span class="co">#&gt; Compute the (log) densities of the posterior sample.</span>
  
  <span class="co"># Structure of a Bliss object</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">)</span>
<span class="co">#&gt; List of 12</span>
<span class="co">#&gt;  $ alpha                 :List of 1</span>
<span class="co">#&gt;   ..$ : num [1:50] 0.0929 0.1019 0.1389 0.2507 0.5564 ...</span>
<span class="co">#&gt;  $ beta_posterior_density:List of 1</span>
<span class="co">#&gt;   ..$ :List of 4</span>
<span class="co">#&gt;   .. ..$ grid_t         : num [1:512] 0 0.00196 0.00391 0.00587 0.00783 ...</span>
<span class="co">#&gt;   .. ..$ grid_beta_t    : num [1:512] -3.1 -3.09 -3.07 -3.06 -3.04 ...</span>
<span class="co">#&gt;   .. ..$ density        : num [1:512, 1:512] 6.42e-17 9.61e-17 1.43e-16 2.13e-16 3.17e-16 ...</span>
<span class="co">#&gt;   .. ..$ new_beta_sample: num [1:800, 1:50] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ beta_sample           :List of 1</span>
<span class="co">#&gt;   ..$ : num [1:1001, 1:50] 0 0 -11.298 0.792 0 ...</span>
<span class="co">#&gt;  $ Bliss_estimate        :List of 1</span>
<span class="co">#&gt;   ..$ : num [1:50, 1] 0 0 0 0 2.89 ...</span>
<span class="co">#&gt;  $ chains                : NULL</span>
<span class="co">#&gt;  $ chains_info           :List of 1</span>
<span class="co">#&gt;   ..$ :List of 2</span>
<span class="co">#&gt;   .. ..$ estimates   :List of 3</span>
<span class="co">#&gt;   .. .. ..$ mu_hat         : num 0.984</span>
<span class="co">#&gt;   .. .. ..$ sigma_sq_hat   : num 0.684</span>
<span class="co">#&gt;   .. .. ..$ Smooth_estimate: num [1:50] 0.206 0.236 0.336 0.665 1.609 ...</span>
<span class="co">#&gt;   .. ..$ autocorr_lag: num [1:50, 1:3] -0.6888 -0.0546 0.1118 0.0637 0.0126 ...</span>
<span class="co">#&gt;   .. .. ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. .. .. ..$ : NULL</span>
<span class="co">#&gt;   .. .. .. ..$ : chr [1:3] "mu" "sigma_sq" "beta"</span>
<span class="co">#&gt;  $ data                  :List of 6</span>
<span class="co">#&gt;   ..$ Q     : num 1</span>
<span class="co">#&gt;   ..$ y     : num [1:100] 0.474 0.647 0.2 2.832 0.275 ...</span>
<span class="co">#&gt;   ..$ x     :List of 1</span>
<span class="co">#&gt;   .. ..$ : num [1:100, 1:50] -1.09 -1.386 -1.037 -2.435 0.739 ...</span>
<span class="co">#&gt;   .. .. ..- attr(*, "scaled:center")= num [1:50] 1.135 1.055 0.952 0.879 0.779 ...</span>
<span class="co">#&gt;   ..$ betas :List of 1</span>
<span class="co">#&gt;   .. ..$ : num [1:50] 0 0 0 0 3 3 3 3 3 3 ...</span>
<span class="co">#&gt;   ..$ grids :List of 1</span>
<span class="co">#&gt;   .. ..$ : num [1:50] 0 0.0204 0.0408 0.0612 0.0816 ...</span>
<span class="co">#&gt;   ..$ x_save:List of 1</span>
<span class="co">#&gt;   .. ..$ : num [1:100, 1:50] 0.045 -0.251 0.0974 -1.3006 1.8735 ...</span>
<span class="co">#&gt;  $ posterior_sample      :List of 3</span>
<span class="co">#&gt;   ..$ trace            : num [1:1001, 1:11] -0.0491 -1.1677 -0.3608 -0.3996 -0.4947 ...</span>
<span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. .. ..$ : NULL</span>
<span class="co">#&gt;   .. .. ..$ : chr [1:11] "b_1" "b_2" "b_3" "m_1" ...</span>
<span class="co">#&gt;   ..$ param            :List of 6</span>
<span class="co">#&gt;   .. ..$ phi_l               :List of 1</span>
<span class="co">#&gt;   .. .. ..$ : num [1:49] 0.2263 0.1666 0.1227 0.0903 0.0665 ...</span>
<span class="co">#&gt;   .. ..$ K                   : num [1, 1] 3</span>
<span class="co">#&gt;   .. ..$ l_values_length     : num [1, 1] 49</span>
<span class="co">#&gt;   .. ..$ potential_intervals :List of 1</span>
<span class="co">#&gt;   .. .. ..$ : num [1:50, 1:49, 1:100] -1.109 -1.112 -1.083 -0.993 -0.857 ...</span>
<span class="co">#&gt;   .. ..$ grids               :List of 1</span>
<span class="co">#&gt;   .. .. ..$ : num [1:50] 0 0.0204 0.0408 0.0612 0.0816 ...</span>
<span class="co">#&gt;   .. ..$ normalization_values:List of 1</span>
<span class="co">#&gt;   .. .. ..$ : num [1:50, 1:49] 0.186 0.237 0.271 0.274 0.273 ...</span>
<span class="co">#&gt;   ..$ posterior_density: num [1:1001, 1:6] 0.00 1.17e-145 2.20e-96 6.92e-16 2.10e-05 ...</span>
<span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. .. ..$ : NULL</span>
<span class="co">#&gt;   .. .. ..$ : chr [1:6] "posterior density" "log posterior density" "likelihood" "log likelihood" ...</span>
<span class="co">#&gt;  $ Smooth_estimate       :List of 1</span>
<span class="co">#&gt;   ..$ : num [1:50, 1] 0.206 0.236 0.336 0.665 1.609 ...</span>
<span class="co">#&gt;  $ support_estimate      :List of 1</span>
<span class="co">#&gt;   ..$ :'data.frame': 2 obs. of  2 variables:</span>
<span class="co">#&gt;   .. ..$ begin: num [1:2] 5 38</span>
<span class="co">#&gt;   .. ..$ end  : num [1:2] 31 50</span>
<span class="co">#&gt;  $ support_estimate_fct  :List of 1</span>
<span class="co">#&gt;   ..$ : num [1:50] 0 0 0 0 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ trace_sann            :List of 1</span>
<span class="co">#&gt;   ..$ : num [1:50001, 1:16] 0.525 0.525 0.525 0.525 -0.216 ...</span>
<span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. .. ..$ : NULL</span>
<span class="co">#&gt;   .. .. ..$ : chr [1:16] "b_1" "b_2" "b_3" "b_4" ...</span>
<span class="co">#&gt;  - attr(*, "class")= chr "bliss"</span></pre></div>
</div>
<div id="graphical-results" class="section level2">
<h2 class="hasAnchor">
<a href="#graphical-results" class="anchor"></a>Graphical results</h2>
<p>This section presents how to obtain main graphical results (posterior quantities) derived from the Bliss method.</p>
<div id="coefficient-function" class="section level3">
<h3 class="hasAnchor">
<a href="#coefficient-function" class="anchor"></a>Coefficient function</h3>
<p>Considering Functional Linear Regression model (FLR), and the specific <em>scalar-on-function</em> case, the major model parameter to infer is the coefficient function <span class="math inline">\(\beta(.)\)</span>. The following chunck shows how to plot the posterior distribution of the coefficient function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
  <span class="va">param</span><span class="op">$</span><span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">beta_posterior_density</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">grid_beta_t</span><span class="op">)</span>,
                      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>
  <span class="va">param</span><span class="op">$</span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="../reference/image_Bliss.html">image_Bliss</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">beta_posterior_density</span>,<span class="va">param</span>,q<span class="op">=</span><span class="fl">1</span><span class="op">)</span></pre></div>
<p><img src="BlissIntro_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>Additionnaly to this plot, one could usually want to display a point estimate of the coefficient function (which is a function). By using the following code, you can access to: * <strong>Bliss estimate</strong>, a piecewise constant version of the coefficient function, and * <strong>the smooth estimate</strong>, the standard bayesian estimate of the coefficient function (standard means that it minimizes the posterior <span class="math inline">\(L^2\)</span>-loss).</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
  <span class="va">param</span><span class="op">$</span><span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">beta_posterior_density</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">grid_beta_t</span><span class="op">)</span>,
                      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>
  <span class="va">param</span><span class="op">$</span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="../reference/image_Bliss.html">image_Bliss</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">beta_posterior_density</span>,<span class="va">param</span>,q<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
  
  <span class="co"># Bliss estimate</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">grids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">res_bliss</span><span class="op">$</span><span class="va">Bliss_estimate</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"s"</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span> 
  
  <span class="co"># Smooth estimate</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">grids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">res_bliss</span><span class="op">$</span><span class="va">Smooth_estimate</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
  
  <span class="co"># True coefficient function</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">grids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">res_bliss</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">betas</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,col<span class="op">=</span><span class="st">"purple"</span>,lwd<span class="op">=</span><span class="fl">2</span>,type<span class="op">=</span><span class="st">"s"</span><span class="op">)</span></pre></div>
<p><img src="BlissIntro_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>The solid black line is Bliss estimate, the dashed black line is the smooth estimate and the solid purple line is the true coefficien function.</p>
<p>Below, the function <code>lines_bliss</code> is used to plot the step function without the vertical lines, linking differents steps.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
  <span class="va">param</span><span class="op">$</span><span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">beta_posterior_density</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">grid_beta_t</span><span class="op">)</span>,
                      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>
  <span class="va">param</span><span class="op">$</span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="../reference/image_Bliss.html">image_Bliss</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">beta_posterior_density</span>,<span class="va">param</span>,q<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
  
  <span class="co"># Bliss estimate</span>
  <span class="fu"><a href="../reference/lines_bliss.html">lines_bliss</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">grids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">res_bliss</span><span class="op">$</span><span class="va">Bliss_estimate</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span> 
  
  <span class="co"># Smooth estimate</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">grids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">res_bliss</span><span class="op">$</span><span class="va">Smooth_estimate</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
  
  <span class="co"># True coefficient function</span>
  <span class="fu"><a href="../reference/lines_bliss.html">lines_bliss</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">grids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">res_bliss</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">betas</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,col<span class="op">=</span><span class="st">"purple"</span>,lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></pre></div>
<p><img src="BlissIntro_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div id="support-of-coefficient-function" class="section level3">
<h3 class="hasAnchor">
<a href="#support-of-coefficient-function" class="anchor"></a>Support of coefficient function</h3>
<p>According to the scientific problematic, one could aim to infer the coefficient function, but it is possible to alternatively focus only on the support of the coefficient function. In this case, the sign and the magniture of the coefficient function could be considered as nuisance parameters. Therefore, the Bliss method provides a specific estimation procedure for the support of the coefficient function (which relies on the posterior distribution of the coefficient function). It consists in deriving the posterior probabilities <span class="math inline">\(\alpha(t|D)\)</span>, for each <span class="math inline">\(t\)</span> in the domain <span class="math inline">\(\mathcal T\)</span> of the functional data, which correspond to the probabilities (conditionnaly to the observed data) that the support of the coefficient function covers the time <span class="math inline">\(t\)</span>.</p>
<p>To plot the posterior probabilities, you have to use the following code :</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">alpha</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"o"</span>,xlab<span class="op">=</span><span class="st">"time"</span>,ylab<span class="op">=</span><span class="st">"posterior probabilities"</span><span class="op">)</span></pre></div>
<p><img src="BlissIntro_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>From these posterior probabilities, the support estimate is derived by thresholding the probabilities. Without prior information guiding the estimation procedure, the default threshold is 0.5. The estimate support is then defined as the collection of time <span class="math inline">\(t\)</span> for which the posterior probability <span class="math inline">\(\alpha(t|D) &gt; 0.5\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">alpha</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"o"</span>,xlab<span class="op">=</span><span class="st">"time"</span>,ylab<span class="op">=</span><span class="st">"posterior probabilities"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.5</span>,col<span class="op">=</span><span class="fl">2</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
  
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">support_estimate</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">support_estimate</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">begin</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="fl">0.05</span>,
           <span class="va">res_bliss</span><span class="op">$</span><span class="va">support_estimate</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">end</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="fl">0.05</span>,col<span class="op">=</span><span class="st">"red"</span>
           <span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">support_estimate</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">begin</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="fl">0.05</span>,col<span class="op">=</span><span class="st">"red"</span>,pch<span class="op">=</span><span class="st">"|"</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res_bliss</span><span class="op">$</span><span class="va">support_estimate</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">end</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="fl">0.05</span>,col<span class="op">=</span><span class="st">"red"</span>,pch<span class="op">=</span><span class="st">"|"</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
  <span class="op">}</span></pre></div>
<p><img src="BlissIntro_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>A resume of the support estimate is provided with:</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="va">res_bliss</span><span class="op">$</span><span class="va">support_estimate</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt;   begin end</span>
<span class="co">#&gt; 2     5  31</span>
<span class="co">#&gt; 4    38  50</span></pre></div>
</div>
</div>
</div>
<div id="multiple-functional-covariates" class="section level1">
<h1 class="hasAnchor">
<a href="#multiple-functional-covariates" class="anchor"></a>Multiple functional covariates</h1>
<p>To avoid unnecesseray computational time, this section is not executed. You could figure out that the functions, objects and procedures are mostly similar to the previous one (single functional covariate case). The main differences are that:</p>
<ul>
<li>number of function covariates have to be specified in the <code>param</code> object, and</li>
<li>posterior quantities are available in elements of output lists.</li>
</ul>
<div id="simulate-a-data-set-1" class="section level2">
<h2 class="hasAnchor">
<a href="#simulate-a-data-set-1" class="anchor"></a>Simulate a data set</h2>
<div class="sourceCode" id="cb10"><pre class="downlit">
   <span class="va">param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Q<span class="op">=</span><span class="fl">2</span>,
                 n<span class="op">=</span><span class="fl">300</span>,
                 p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">60</span><span class="op">)</span>,
                 beta_shapes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"simple"</span>,<span class="st">"smooth"</span><span class="op">)</span>,
                 grids_lim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim.html">sim</a></span><span class="op">(</span><span class="va">param</span><span class="op">)</span></pre></div>
</div>
<div id="how-to-apply-the-bliss-method-1" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-apply-the-bliss-method-1" class="anchor"></a>How to apply the Bliss method</h2>
<div class="sourceCode" id="cb11"><pre class="downlit">
  <span class="va">param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>       <span class="co"># define the required values of the Bliss method.</span>
     iter<span class="op">=</span><span class="fl">1e3</span>,         <span class="co"># The number of iteration of the main numerical algorithm of Bliss.</span>
     burnin<span class="op">=</span><span class="fl">2e2</span>,       <span class="co"># The number of burnin iteration for the Gibbs Sampler</span>
     K<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>         <span class="co"># The number of intervals of the beta</span>

  <span class="va">res_Bliss_mult</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_Bliss.html">fit_Bliss</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">data</span>,param<span class="op">=</span><span class="va">param</span><span class="op">)</span></pre></div>
</div>
<div id="graphical-results-1" class="section level2">
<h2 class="hasAnchor">
<a href="#graphical-results-1" class="anchor"></a>Graphical results</h2>
<div class="sourceCode" id="cb12"><pre class="downlit">
   <span class="va">q</span> <span class="op">&lt;-</span> <span class="fl">1</span>
   <span class="va">param</span><span class="op">$</span><span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">beta_posterior_density</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">grid_beta_t</span><span class="op">)</span>,
                       <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>
   <span class="va">param</span><span class="op">$</span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>
   <span class="fu"><a href="../reference/image_Bliss.html">image_Bliss</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">beta_posterior_density</span>,<span class="va">param</span>,q<span class="op">=</span><span class="va">q</span><span class="op">)</span>
   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">grids</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,<span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">Bliss_estimate</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"s"</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">grids</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,<span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">betas</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,col<span class="op">=</span><span class="fl">2</span>,lwd<span class="op">=</span><span class="fl">2</span>,type<span class="op">=</span><span class="st">"s"</span><span class="op">)</span>

  <span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">Bliss_estimate</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,
                 <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">Smooth_estimate</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
   <span class="fu"><a href="../reference/plot_bliss.html">plot_bliss</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">grids</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,
              <span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">Bliss_estimate</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">2</span>,ylim<span class="op">=</span><span class="va">ylim</span><span class="op">)</span>
   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">grids</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,
         <span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">Smooth_estimate</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>


   <span class="va">q</span> <span class="op">&lt;-</span> <span class="fl">2</span>
   <span class="va">param</span><span class="op">$</span><span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">beta_posterior_density</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">grid_beta_t</span><span class="op">)</span>,
                       <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>
   <span class="va">param</span><span class="op">$</span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>
   <span class="fu"><a href="../reference/image_Bliss.html">image_Bliss</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">beta_posterior_density</span>,<span class="va">param</span>,q<span class="op">=</span><span class="va">q</span><span class="op">)</span>
   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">grids</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,<span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">Bliss_estimate</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"s"</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">grids</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,<span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">betas</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,col<span class="op">=</span><span class="fl">2</span>,lwd<span class="op">=</span><span class="fl">2</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>
   
   <span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">Bliss_estimate</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,
                 <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">Smooth_estimate</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
   <span class="fu"><a href="../reference/plot_bliss.html">plot_bliss</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">grids</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,
              <span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">Bliss_estimate</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">2</span>,ylim<span class="op">=</span><span class="va">ylim</span><span class="op">)</span>
   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">grids</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,
         <span class="va">res_Bliss_mult</span><span class="op">$</span><span class="va">Smooth_estimate</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></pre></div>
</div>
</div>
<div id="session-informations" class="section level1">
<h1 class="hasAnchor">
<a href="#session-informations" class="anchor"></a>Session informations</h1>
<pre><code>#&gt; R version 4.0.3 (2020-10-10)
#&gt; Platform: x86_64-w64-mingw32/x64 (64-bit)
#&gt; Running under: Windows 10 x64 (build 19042)
#&gt; 
#&gt; Matrix products: default
#&gt; 
#&gt; locale:
#&gt; [1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252   
#&gt; [3] LC_MONETARY=French_France.1252 LC_NUMERIC=C                  
#&gt; [5] LC_TIME=French_France.1252    
#&gt; 
#&gt; attached base packages:
#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     
#&gt; 
#&gt; other attached packages:
#&gt; [1] bliss_1.0.3
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;  [1] zip_2.1.1                Rcpp_1.0.7               nloptr_1.2.2.2          
#&gt;  [4] bslib_0.2.4              compiler_4.0.3           jquerylib_0.1.3         
#&gt;  [7] plyr_1.8.6               tools_4.0.3              boot_1.3-25             
#&gt; [10] digest_0.6.27            lme4_1.1-23              statmod_1.4.34          
#&gt; [13] nlme_3.1-149             jsonlite_1.7.2           evaluate_0.14           
#&gt; [16] memoise_1.1.0            lattice_0.20-41          rlang_0.4.10            
#&gt; [19] Matrix_1.2-18            openxlsx_4.2.2           rstudioapi_0.13         
#&gt; [22] rockchalk_1.8.144        yaml_2.2.1               pkgdown_1.6.1           
#&gt; [25] xfun_0.25                RcppArmadillo_0.10.1.2.0 stringr_1.4.0           
#&gt; [28] knitr_1.30               desc_1.2.0               fs_1.5.0                
#&gt; [31] sass_0.3.0               systemfonts_0.3.2        rprojroot_2.0.2         
#&gt; [34] grid_4.0.3               R6_2.5.0                 foreign_0.8-80          
#&gt; [37] rmarkdown_2.10           minqa_1.2.4              carData_3.0-4           
#&gt; [40] magrittr_2.0.1           htmltools_0.5.1.1        MASS_7.3-53             
#&gt; [43] kutils_1.70              splines_4.0.3            assertthat_0.2.1        
#&gt; [46] xtable_1.8-4             ragg_0.3.1               stringi_1.5.3           
#&gt; [49] crayon_1.3.4</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Paul-Marie Grollemund.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
